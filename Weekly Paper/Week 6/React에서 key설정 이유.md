# 🧩 React에서 배열 렌더링 시 `key`를 설정해야 하는 이유

> React는 배열을 렌더링할 때 각 요소의 “고유한 식별자(key)”를 통해 어떤 항목이 변경/추가/삭제되었는지를 파악해요.
> 

---

### ✅ 이유 1. **효율적인 렌더링 (성능 향상)**

- key를 통해 **Virtual DOM의 diff 알고리즘**이 어떤 요소가 바뀌었는지 정확하게 추적 가능
- key가 없다면 React는 **전체 배열을 다시 렌더링**하게 되어 성능이 떨어짐

---

### ✅ 이유 2. **UI 이상 방지**

- key가 없거나 중복되면 React가 **렌더링 순서를 잘못 판단**해 예상치 못한 UI 오류 발생 가능
- 예: 리스트 중 하나만 수정했는데 전체가 깜빡거리거나 순서가 꼬이는 현상

---

## ⚠️ key 설정 시 주의할 점

| 주의 사항 | 설명 |
| --- | --- |
| 🔢 `index` 사용은 **가능하면 피하기** | 리스트 항목이 **변경/삭제/삽입되는 경우** 잘못된 UI 업데이트 발생 위험 |
| 🔐 **고유한 값 사용하기** | 데이터의 고유 ID(`item.id`)처럼 **절대 중복되지 않는 값**을 사용하는 것이 좋음 |
| 🔁 key는 **항상 같은 항목에 고정** | key가 바뀌면 해당 요소를 **새로 생성**한 것으로 인식하여 비효율적 처리 가능 |

---

## 💡 예시 코드

```jsx
// ✅ 좋은 예: 고유한 ID 사용
{items.map(item => (
  <li key={item.id}>{item.name}</li>
))}

// ⚠️ 나쁜 예: 인덱스 사용 (순서가 바뀌면 문제 발생 가능)
{items.map((item, index) => (
  <li key={index}>{item.name}</li>
))}

```

---

## ✅ 핵심 정리

| 항목 | 설명 |
| --- | --- |
| key 역할 | 요소의 **고유 식별자**로, React가 어떤 항목이 바뀌었는지 빠르게 판단 |
| 좋은 key | **고유하고 변하지 않는 값** (예: 데이터의 ID) |
| index를 key로 쓸 경우 | **정렬이나 항목 수정이 없는 경우에만 사용 권장** |


# 모범 답안

## 📌 React에서 배열 렌더링 시 `key`를 설정해야 하는 이유와 주의할 점

---

### 1️⃣ **왜 key가 필요한가?**

- `key`는 **React가 리스트 항목을 고유하게 식별**하는 기준입니다.
- 리스트 요소가 **추가/삭제/재정렬**될 때, 어떤 요소가 변경되었는지를 빠르게 파악하여 **필요한 부분만 갱신**할 수 있게 합니다.
- 이를 통해 **불필요한 DOM 재생성**을 방지하고 **렌더링 성능**을 최적화합니다.

**예시**

```jsx
const listItems = items.map(item =>
  <li key={item.id}>{item.name}</li>
);
```

---

### 2️⃣ **key가 없으면 생기는 문제**

- React는 각 요소의 변화를 구분할 수 없어, **모든 요소를 새로 렌더링**하게 됩니다.
- 이는 **성능 저하**와 **불필요한 DOM 조작**을 유발합니다.

---

### 3️⃣ **key 설정 시 주의할 점**

### ✅ 고유한 값 사용

- 동일한 리스트 내에서 `key`는 **중복되지 않아야 함**.
- **데이터베이스 ID**, **UUID** 등 **변하지 않는 값** 사용 권장.

```jsx
// 좋은 예시: 고유한 ID 사용
const listItems = items.map(item =>
  <li key={item.id}>{item.name}</li>
);
```

### ⚠️ 인덱스 사용 주의

- 배열 인덱스를 `key`로 쓰면, **요소 추가/삭제/정렬 시** 인덱스가 바뀌어 버그가 생길 수 있음.
- 특히 **동적인 리스트**에서는 피해야 함.

```jsx
// 나쁜 예시: 인덱스 사용
const listItems = items.map((item, index) =>
  <li key={index}>{item.name}</li>
);
```

---

### 4️⃣ **예외적으로 인덱스 사용 가능할 때**

- **정적인 리스트**이거나, 절대 변경/정렬되지 않는 경우
- 이 경우 인덱스 사용이 성능상 문제를 만들지 않음

```jsx
// 예외 상황: 변하지 않는 리스트
const staticItems = ['Item1', 'Item2', 'Item3'];
const listItems = staticItems.map((item, index) =>
  <li key={index}>{item}</li>
);
```

---

### 📌 **결론**

- **원칙**: 변하지 않는 **고유 식별자**를 `key`로 사용
- **지양**: 인덱스를 `key`로 사용 (동적 리스트에서 특히 위험)
- **효과**: DOM 변경 최소화 → 성능 최적화 & 예기치 않은 버그 방지
